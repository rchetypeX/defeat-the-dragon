(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4178:function(e,t,s){Promise.resolve().then(s.bind(s,4455))},4455:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var a=s(7573),i=s(7653),n=s(6569);function r(){let[e,t]=(0,i.useState)(""),[s,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),{signIn:u}=(0,n.a)(),m=async t=>{t.preventDefault(),l(!0),d(null);let{error:a}=await u(e,s);a&&d(a.message),l(!1)};return(0,a.jsxs)("div",{className:"max-w-md mx-auto pixel-card p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center mb-6 text-[#f2751a]",children:"Sign In"}),c&&(0,a.jsx)("div",{className:"bg-[#ef4444] text-white p-3 mb-4 border-2 border-[#654321]",children:c}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium mb-2 text-[#fbbf24]",children:"Email"}),(0,a.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full pixel-input",placeholder:"Enter your email"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium mb-2 text-[#fbbf24]",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",value:s,onChange:e=>r(e.target.value),required:!0,className:"w-full pixel-input",placeholder:"Enter your password"})]}),(0,a.jsx)("button",{type:"submit",disabled:o,className:"w-full pixel-button disabled:opacity-50",children:o?"Signing in...":"Sign In"})]})]})}function o(){let[e,t]=(0,i.useState)(""),[s,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(null),[x,p]=(0,i.useState)(!1),[h,g]=(0,i.useState)(!1),[b,f]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1),{signUp:w}=(0,n.a)(),k=async t=>{if(t.preventDefault(),b){m("An account with this email already exists. Please sign in instead.");return}d(!0),m(null),p(!1);let{error:a}=await w(e,s,o);a?(m(a.message),p(!1)):(p(!0),m(null)),d(!1)},N=async e=>{if(!e||!e.includes("@")){f(!1);return}g(!0);try{let t=await fetch("/api/auth/check-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(t.ok){let e=await t.json();f(e.exists),e.exists?m("An account with this email already exists. Please sign in instead."):m(null)}else console.warn("Email check API failed, proceeding with signup"),m("Email availability check failed. Please try again or proceed with signup.")}catch(e){console.error("Error checking email:",e),m("Email availability check failed. Please try again or proceed with signup.")}finally{g(!1)}};return x?(0,a.jsx)("div",{className:"max-w-md mx-auto pixel-card p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 text-[#f2751a]",children:"\uD83C\uDF89 Welcome, Adventurer!"}),(0,a.jsx)("p",{className:"text-[#fbbf24] mb-4",children:"Check your email to confirm your account and begin your journey!"}),(0,a.jsx)("div",{className:"bg-[#22c55e] text-white p-3 border-2 border-[#654321]",children:"Account created successfully!"})]})}):(0,a.jsxs)("div",{className:"max-w-md mx-auto pixel-card p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center mb-6 text-[#f2751a]",children:"Join the Adventure"}),u&&(0,a.jsx)("div",{className:"bg-[#ef4444] text-white p-3 mb-4 border-2 border-[#654321]",children:u}),(0,a.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium mb-2 text-[#fbbf24]",children:"Adventurer Name"}),(0,a.jsx)("input",{id:"displayName",type:"text",value:o,onChange:e=>l(e.target.value),required:!0,maxLength:20,className:"w-full pixel-input text-xs placeholder:text-xs",placeholder:"Enter adventurer name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium mb-2 text-[#fbbf24]",children:"Email"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>{let s=e.target.value;t(s),m(null),f(!1);let a=setTimeout(()=>{N(s)},500);return()=>clearTimeout(a)},required:!0,className:"w-full pixel-input text-xs placeholder:text-xs ".concat(b?"border-red-500":""),placeholder:"Enter email"}),h&&(0,a.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#f2751a]"})}),b&&(0,a.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-red-500",children:"❌"})]}),b&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"This email is already registered. Please sign in instead."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium mb-2 text-[#fbbf24]",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"password",type:v?"text":"password",value:s,onChange:e=>r(e.target.value),required:!0,minLength:6,className:"w-full pixel-input text-xs placeholder:text-xs pr-10",placeholder:"Enter password"}),(0,a.jsx)("button",{type:"button",onClick:()=>y(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-[#8B4513] hover:text-[#654321]",children:v?"\uD83D\uDE48":"\uD83D\uDC41️"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:c||b||h,className:"w-full pixel-button disabled:opacity-50",children:c?"Creating Account...":b?"Email Already Exists":"Start Adventure"})]})]})}var l=s(5485),c=s(2277);function d(e){let{onSessionStart:t,onSessionCancel:s}=e,[n,r]=(0,i.useState)(5),[o,l]=(0,i.useState)(!1),d=(0,c.actionForMinutes)(n),u=c.actionMetadata[d];(0,c.getValidDurations)();let m=(0,i.useCallback)(e=>{(0,c.isValidDuration)(e)&&r(e)},[]),x=async()=>{l(!0);try{console.log("SessionTimer: Starting session with:",{currentAction:d,minutes:n}),await t(d,n),console.log("SessionTimer: Session started successfully"),l(!1)}catch(e){console.error("SessionTimer: Failed to start session:",e),l(!1)}};return(0,a.jsxs)("div",{className:"pixel-card p-4 max-w-sm mx-auto",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-center mb-4 text-[#f2751a]",children:"Start Your Focus Session"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-bold mb-2 text-[#f2751a]",children:["Duration: ",(0,a.jsxs)("span",{className:"text-lg",children:[n," minutes"]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"range",min:"5",max:"120",step:"5",value:n,onChange:e=>{m(parseInt(e.target.value))},className:"w-full h-2 bg-[#8B4513] rounded-lg appearance-none cursor-pointer slider",style:{background:"linear-gradient(to right, #f2751a 0%, #f2751a ".concat((n-5)/115*100,"%, #8B4513 ").concat((n-5)/115*100,"%, #8B4513 100%)")}}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-[#fbbf24] mt-1",children:[(0,a.jsx)("span",{children:"5m"}),(0,a.jsx)("span",{children:"60m"}),(0,a.jsx)("span",{children:"120m"})]})]})]}),(0,a.jsx)("div",{className:"mb-4 text-center",children:(0,a.jsxs)("div",{className:"pixel-card p-3",children:[(0,a.jsx)("div",{className:"text-3xl mb-1",children:u.emoji}),(0,a.jsx)("h3",{className:"text-base font-bold text-[#f2751a] mb-1",children:u.label}),(0,a.jsx)("p",{className:"text-xs text-[#fbbf24]",children:u.description})]})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:s,className:"flex-1 pixel-button bg-[#8B4513] hover:bg-[#654321] text-xs py-2",children:"Cancel"}),(0,a.jsx)("button",{onClick:x,disabled:o,className:"flex-1 pixel-button disabled:opacity-50 text-xs py-2",children:o?"Starting":"Start"})]})]})}class u{setupVisibilityListener(){document.addEventListener("visibilitychange",()=>{this.state.isActive&&(document.hidden?this.handlePageHidden():this.handlePageVisible())}),window.addEventListener("blur",()=>{this.state.isActive&&this.handlePageHidden()}),window.addEventListener("focus",()=>{this.state.isActive&&this.handlePageVisible()})}handlePageHidden(){this.state.awayStartTime||(this.state.awayStartTime=Date.now(),console.log("SoftShield: Page hidden, starting away timer"))}handlePageVisible(){if(this.state.awayStartTime){let e=Math.floor((Date.now()-this.state.awayStartTime)/1e3);this.state.totalAwayTime+=e,this.state.awayStartTime=null,console.log("SoftShield: Page visible, was away for ".concat(e,"s, total: ").concat(this.state.totalAwayTime,"s")),e>0&&(this.state.isDisturbed=!0,this.onDisturbance(e)),this.state.totalAwayTime=0,this.state.isDisturbed=!1,this.state.lastWarningTime=null,console.log("SoftShield: User returned, resetting state and clearing warning")}else this.state.isDisturbed&&(this.state.isDisturbed=!1,console.log("SoftShield: User returned, clearing disturbed state"))}startChecking(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{if(!this.state.isActive)return;let e=Date.now(),t=this.state.totalAwayTime;if(this.state.awayStartTime&&(t+=Math.floor((e-this.state.awayStartTime)/1e3)),t>=this.config.warningTime&&t<this.config.maxAwayTime&&!this.state.lastWarningTime&&(this.onWarning(5),this.state.lastWarningTime=e,console.log("SoftShield: Warning triggered - starting 5 second countdown, current away time: ".concat(t,"s"))),this.state.lastWarningTime){let t=e-this.state.lastWarningTime,s=Math.max(0,5e3-t);if(s>0){let e=Math.max(1,Math.ceil(s/1e3));console.log("SoftShield: Countdown - timeSinceWarning: ".concat(t,"ms, remainingTime: ").concat(s,"ms, remainingSeconds: ").concat(e,"s")),this.onWarning(e)}else console.log("SoftShield: Warning time expired, session should fail"),this.onWarning(0),setTimeout(()=>this.fail(),100)}t>=this.config.maxAwayTime&&(console.log("SoftShield: Max away time reached (".concat(t,"s), failing session")),this.fail())},this.config.checkInterval)}stopChecking(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}start(){this.state.isActive=!0,this.state.isDisturbed=!1,this.state.awayStartTime=null,this.state.totalAwayTime=0,this.state.lastWarningTime=null,console.log("SoftShield: Started"),this.startChecking()}stop(){this.state.isActive=!1,this.stopChecking(),console.log("SoftShield: Stopped")}fail(){if(!this.state.isActive)return;let e=this.state.totalAwayTime;this.stop(),this.onFail(e),console.log("SoftShield: Failed after ".concat(e,"s away"))}getState(){return{...this.state}}getCurrentAwayTime(){if(!this.state.isActive)return 0;let e=this.state.totalAwayTime;return this.state.awayStartTime&&(e+=Math.floor((Date.now()-this.state.awayStartTime)/1e3)),e}reset(){this.state.totalAwayTime=0,this.state.isDisturbed=!1,this.state.lastWarningTime=null}clearDisturbed(){this.state.isDisturbed=!1,console.log("SoftShield: Disturbed state cleared")}constructor(e={},t={}){this.checkInterval=null,this.config={maxAwayTime:15,warningTime:10,checkInterval:1e3,...e},this.state={isActive:!1,isDisturbed:!1,awayStartTime:null,totalAwayTime:0,lastWarningTime:null},this.onDisturbance=t.onDisturbance||(()=>{}),this.onWarning=t.onWarning||(()=>{}),this.onFail=t.onFail||(()=>{}),this.setupVisibilityListener()}}function m(e){let{remainingTime:t,onDismiss:s}=e,[n,r]=(0,i.useState)(!0),[o,l]=(0,i.useState)(t);return((0,i.useEffect)(()=>{if(l(t),t<=0){r(!1),null==s||s();return}if(t>0){let e=setInterval(()=>{l(e=>{let t=Math.max(0,e-1);return t<=0?0:t})},1e3);return()=>clearInterval(e)}},[t,s]),(0,i.useEffect)(()=>{o<=0&&t<=0&&(r(!1),null==s||s())},[o,t,s]),n)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"pixel-card p-6 max-w-sm w-full text-center bg-[#dc2626] border-4 border-[#991b1b]",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Focus Interrupted!"}),(0,a.jsx)("p",{className:"text-white mb-4",children:"You've been away from the app for too long. Return to continue your focus session!"}),(0,a.jsxs)("div",{className:"bg-[#991b1b] border-2 border-[#7f1d1d] p-3 mb-4",children:[(0,a.jsx)("div",{className:"text-white text-sm mb-1",children:"Time remaining before session fails:"}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-white",children:[o,"s"]})]}),(0,a.jsx)("div",{className:"text-white text-sm",children:"⚡ Stay focused! Your tiny adventurer needs you!"})]})}):null}async function x(){return"Notification"in window?"granted"===Notification.permission||("denied"===Notification.permission?(console.log("Notification permission denied"),!1):"granted"===await Notification.requestPermission()):(console.log("This browser does not support notifications"),!1)}let p=(0,i.createContext)(void 0),h=()=>{let e=(0,i.useContext)(p);if(void 0===e)throw Error("useAudio must be used within an AudioProvider");return e},g=e=>{let{children:t}=e,[s,n]=(0,i.useState)({backgroundVolume:.3,focusSessionVolume:.4,isBackgroundPlaying:!1,isFocusSessionPlaying:!1,isSessionActive:!1}),[r,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{o(!0);{let e=localStorage.getItem("backgroundVolume"),t=localStorage.getItem("focusSessionVolume");(e||t)&&n(s=>({...s,backgroundVolume:e?parseFloat(e):s.backgroundVolume,focusSessionVolume:t?parseFloat(t):s.focusSessionVolume}))}},[]),(0,i.useEffect)(()=>{r&&(localStorage.setItem("backgroundVolume",s.backgroundVolume.toString()),localStorage.setItem("focusSessionVolume",s.focusSessionVolume.toString()))},[s.backgroundVolume,s.focusSessionVolume,r]);let l=(0,i.useCallback)(e=>{n(t=>({...t,backgroundVolume:e}))},[]),c=(0,i.useCallback)(e=>{n(t=>({...t,focusSessionVolume:e}))},[]),d=(0,i.useCallback)(e=>{n(t=>({...t,isBackgroundPlaying:e}))},[]),u=(0,i.useCallback)(e=>{n(t=>({...t,isFocusSessionPlaying:e}))},[]),m=(0,i.useCallback)(e=>{n(t=>({...t,isSessionActive:e}))},[]),x=(0,i.useCallback)(()=>{n(e=>{let t={...e,isBackgroundPlaying:!e.isBackgroundPlaying};return console.log("AudioContext: Background play/pause toggled:",t.isBackgroundPlaying),t})},[]),h=(0,i.useCallback)(()=>{n(e=>{let t={...e,isFocusSessionPlaying:!e.isFocusSessionPlaying};return console.log("AudioContext: Focus session play/pause toggled:",t.isFocusSessionPlaying),t})},[]),g=(0,i.useMemo)(()=>({...s,setBackgroundVolume:l,setFocusSessionVolume:c,setBackgroundPlaying:d,setFocusSessionPlaying:u,setSessionActive:m,toggleBackgroundPlayPause:x,toggleFocusSessionPlayPause:h}),[s,l,c,d,u,m,x,h]);return(0,a.jsx)(p.Provider,{value:g,children:t})};var b=s(7582),f=s(4452);let v=(0,b.Ue)()((0,f.tJ)((e,t)=>({equippedCharacter:"fighter",setEquippedCharacter:t=>{e({equippedCharacter:t})},getCharacterImage:e=>{let t={fighter:"/assets/sprites/fighter.png",wizard:"/assets/sprites/wizard.png",paladin:"/assets/sprites/paladin.png",rogue:"/assets/sprites/rogue.png"};return t[e]||t.fighter}}),{name:"defeat-the-dragon-character-storage"}));var y=e=>{let{isOpen:t,onClose:s}=e,{focusSessionVolume:i,setFocusSessionVolume:n,isFocusSessionPlaying:r,toggleFocusSessionPlayPause:o}=h();return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-[#1a1a2e] border-2 border-[#f2751a] rounded-lg p-4 max-w-xs w-full pixel-card",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"text-[#f2751a] font-bold text-sm",children:"\uD83C\uDFB5 Focus Session Audio"}),(0,a.jsx)("button",{onClick:s,className:"text-[#fbbf24] hover:text-white transition-colors text-lg",children:"✕"})]}),(0,a.jsx)("div",{className:"flex justify-center mb-3",children:(0,a.jsx)("button",{onClick:()=>{console.log("FocusSessionAudioControls: Play/pause clicked, current state:",r),o()},className:"px-4 py-2 bg-[#f2751a] hover:bg-[#e65a0a] transition-colors rounded text-white text-sm font-bold",children:r?"⏸️ Pause Music":"▶️ Play Music"})}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-[#fbbf24] text-xs",children:"\uD83D\uDD0A Volume"}),(0,a.jsxs)("span",{className:"text-[#fbbf24] text-xs min-w-[2rem]",children:[Math.round(100*i),"%"]})]}),(0,a.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:i,onChange:e=>n(parseFloat(e.target.value)),className:"w-full h-2 bg-[#2a2a3e] rounded-lg appearance-none cursor-pointer slider"})]}),(0,a.jsx)("div",{className:"text-center text-[#fbbf24] text-xs",children:(0,a.jsx)("p",{children:"Music will play during your focus session"})})]})}):null};function w(e){let{onSessionComplete:t,onSessionFail:s}=e,{currentSession:n,sessionProgress:r,updateSessionProgress:o,player:d}=(0,l.g)(),{isBackgroundPlaying:x,toggleBackgroundPlayPause:p}=h(),{equippedCharacter:g,getCharacterImage:b}=v(),[f,w]=(0,i.useState)(0),[k,N]=(0,i.useState)(!1),[j,S]=(0,i.useState)(!1),[T,P]=(0,i.useState)(0),[M,E]=(0,i.useState)(null),[D,C]=(0,i.useState)(!1),[z,A]=(0,i.useState)(!1),[L,F]=(0,i.useState)(""),_=(0,i.useRef)(null),X=(null==n?void 0:n.action)||"Train",B=c.actionMetadata[X],I=(e,t,s)=>{var a;let i=Math.min(Math.floor(t/s*9),8),n={Train:["Quick drills! Let the screen nap for me.","Stretch… stance… no peeks yet.","Counting reps—guard the quiet.","Form's getting tidy; keep hands off.","Mid-set focus—thank you for the stillness.","Sweat sparkle—no taps, I'm in rhythm.","Almost there—hold the calm a little longer.","Final reps; keep the phone snoozy.","Done in a blink—stay steady till the bell!"],Eat:["Snack time—silence makes food tastier.","Nibble, nibble—no scrolling, promise?","Chewing thoughtfully; keep the screen asleep.","Savoring bites—thanks for not poking.","Halfway plate—hands-off teamwork!","Crunch-crunch—don't wake the phone.","Last bites coming up—hold the quiet.","Sip and finish—nearly done.","Clean plate soon—stay still with me."],Learn:["Opening the tome—shhh.","Tracing lines—no peeks, please.","Notes in the margins; keep things calm.","Mid-chapter focus—guard the silence.","Idea spark! Don't break the bubble.","Turning a page—no taps while I think.","Nearly through this lesson—hold steady.","Reviewing highlights—screen stays sleepy.","Closing the book—one more quiet moment."],Bathe:["Steam rising—I'm bathing.","Soapy whiskers—don't jostle me.","Rinse cycle; keep the phone dozy.","Scrub-scrub—thank you for the stillness.","Warm fog focus—no taps.","Towel ready—almost squeaky.","Final rinse; let the screen snooze.","Drying off—hold the calm.","All clean soon—stay hands-off till I sparkle."],Sleep:["Curling up—tiny nap mode.","Zzz… quiet helps me dream.","Breathing slow; keep the phone resting.","Dozing deeper—no peeks.","Half-nap checkpoint—thank you for stillness.","Soft snores—don't wake the screen.","Stirring soon—hold the hush.","Almost refreshed—one more quiet minute.","Waking stretch—keep it calm till the chime."],Maintain:["Gear check—maintaining my equipment.","Oiling hinges; no taps while I focus.","Sharpening edges—thanks for the calm.","Polish pass; keep hands off.","Tightening straps—screen stays sleepy.","Details, details—don't break my groove.","Final polish—hold the quiet.","Everything gleams—almost done.","Toolkit closing—stay steady till the tick."],Fight:["Stance set—I'm fighting these mobs.","First wave—no peeks, I've got this.","Combo time—keep the phone still.","Dodging neatly; thanks for the hush.","Mid-battle—don't wake the screen.","Special ready—hold the calm.","Last few foes—hands off till I finish.","Boss staggered—nearly there.","Victory incoming—stay steady for the win!"],Adventure:["Lantern lit—I'm going on an adventure.","Path forks ahead—no distractions.","Tracking footprints; keep the phone sleepy.","Torch high—thanks for the stillness.","Deeper in—don't jostle my map.","Treasure glint—hold the calm.","Gate in sight—hands off, brave friend.","Chest unlocked—almost done.","Loot secured—keep it quiet till I return!"]};return(null===(a=n[e])||void 0===a?void 0:a[i])||n.Train[i]||"Focusing..."};return(console.log("SessionProgress render:",{currentSession:!!n,sessionProgress:{isActive:r.isActive,startTime:r.startTime,durationMinutes:r.durationMinutes,isDisturbed:r.isDisturbed},timeLeft:f}),(0,i.useEffect)(()=>(r.isActive&&!_.current&&(console.log("SessionProgress: Creating SoftShield..."),_.current=new u({maxAwayTime:15,warningTime:10},{onDisturbance:e=>{console.log("SoftShield: Disturbed for ".concat(e,"s")),o({isDisturbed:!0,disturbedSeconds:r.disturbedSeconds+e})},onWarning:e=>{console.log("SoftShield: Warning triggered - ".concat(e,"s remaining")),!j&&(S(!0),E(Date.now()),"granted"===Notification.permission&&new Notification("⚠️ Focus Interrupted!",{body:"You've been away too long! Return within ".concat(e," seconds or your session will fail!"),icon:"/icons/icon-144x144.png",badge:"/icons/icon-144x144.png",tag:"soft-shield-warning",requireInteraction:!0}),console.log("SessionProgress: Warning state set to true")),P(e)},onFail:e=>{console.log("SoftShield: Failed after ".concat(e,"s away")),s()}}),console.log("SessionProgress: Starting SoftShield..."),_.current.start()),()=>{_.current&&(_.current.stop(),_.current=null)}),[r.isActive,o,r.disturbedSeconds,s]),(0,i.useEffect)(()=>{if(_.current&&r.isActive){let e=_.current.getState();e.isDisturbed===k||(N(e.isDisturbed),e.isDisturbed||o({isDisturbed:!1})),j&&!e.lastWarningTime&&(console.log("SessionProgress: User returned, clearing warning"),S(!1),P(0),E(null))}},[r.isActive,k,o,j]),(0,i.useEffect)(()=>{if(!r.isActive||!r.startTime)return;let e=setInterval(()=>{let a=Math.floor((Date.now()-r.startTime)/1e3),i=60*r.durationMinutes-a;w(Math.max(0,i)),N(r.isDisturbed),F(I(X,a,60*r.durationMinutes)),i<=0&&(clearInterval(e),_.current&&_.current.stop(),r.isDisturbed?(console.log("SessionProgress: Timer reached zero but session was disturbed, calling onSessionFail"),s()):(console.log("SessionProgress: Timer reached zero, calling onSessionComplete"),t()))},1e3);return()=>clearInterval(e)},[r.isActive,r.startTime,r.durationMinutes,r.isDisturbed,t,s,X]),(0,i.useEffect)(()=>{r.isActive||(_.current&&(_.current.stop(),_.current=null),S(!1),P(0),N(!1),C(!1),F(""))},[r.isActive]),(0,i.useEffect)(()=>{j&&T<=0&&(console.log("SessionProgress: Warning time expired, dismissing warning"),S(!1),P(0),E(null),setTimeout(()=>{_.current&&_.current.getState().isDisturbed&&(console.log("SessionProgress: Session was disturbed, calling onSessionFail"),s())},200))},[j,T,s]),r.isActive&&B)?(0,a.jsxs)(a.Fragment,{children:[j&&(0,a.jsx)(m,{remainingTime:T,onDismiss:()=>S(!1)}),(0,a.jsx)("div",{className:"fixed inset-0 pointer-events-none z-20",children:(0,a.jsx)("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, transparent 0%, transparent 30%, rgba(0, 0, 0, 0.7) 70%, rgba(0, 0, 0, 0.9) 100%)",backgroundSize:"100% 100%",backgroundPosition:"center"}})}),(0,a.jsx)("div",{className:"fixed left-1/2 transform -translate-x-1/2 bottom-40 sm:bottom-44 z-25",children:(0,a.jsx)("img",{src:b(g),alt:"Tiny Adventurer",className:"w-32 h-36 sm:w-36 sm:h-40 pixel-art drop-shadow-lg object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,a.jsx)("div",{className:"fixed left-1/2 transform -translate-x-1/2 bottom-80 sm:bottom-84 z-30",children:(0,a.jsxs)("div",{className:"pixel-card p-3 sm:p-4 bg-white border-2 border-gray-800 max-w-xs sm:max-w-sm text-center relative",children:[(0,a.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-white"}),(0,a.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-7 border-r-7 border-t-7 border-transparent border-t-gray-800",style:{marginTop:"-1px"}}),(0,a.jsx)("div",{className:"text-gray-800 text-xs sm:text-sm font-medium leading-tight",children:L})]})}),(0,a.jsxs)("div",{className:"fixed top-8 left-1/2 transform -translate-x-1/2 z-30 text-center",children:[(0,a.jsx)("div",{className:"text-4xl sm:text-5xl font-bold text-white drop-shadow-lg mb-2",children:"".concat(Math.floor(f/60),":").concat((f%60).toString().padStart(2,"0"))}),(0,a.jsxs)("div",{className:"text-sm sm:text-base text-[#fbbf24] drop-shadow-lg",children:["to go until ",{Train:"I finish training.",Eat:"I'm done eating",Learn:"I finish reading",Bathe:"I'm done bathing",Sleep:"I wake up",Maintain:"I finish maintaining my equipment",Fight:"I'm done fighting these mobs",Adventure:"I'm back from my adventure"}[X]||"I finish training."]})]}),(0,a.jsx)("div",{className:"fixed top-4 right-4 z-30",children:(0,a.jsx)("img",{src:"/assets/icons/sound.png",alt:"Sound",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art cursor-pointer hover:opacity-80 transition-opacity drop-shadow-lg",onClick:()=>A(!0)})}),(0,a.jsx)("div",{className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 z-30",children:(0,a.jsx)("button",{onClick:()=>C(!0),className:"pixel-button bg-[#ef4444] hover:bg-[#dc2626] text-white px-6 py-3 text-base sm:text-lg",children:"STOP FOCUSING"})}),D&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"pixel-card p-6 sm:p-8 border-2 border-[#ef4444] bg-[#1f2937] max-w-md w-full mx-4",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"text-white text-lg sm:text-xl font-bold mb-2",children:"Are you sure?"}),(0,a.jsxs)("div",{className:"text-[#fbbf24] text-sm sm:text-base",children:[(null==d?void 0:d.display_name)||"Adventurer"," still needs to focus..."]})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,a.jsx)("button",{onClick:s,className:"pixel-button bg-[#ef4444] hover:bg-[#dc2626] text-white px-6 py-2 text-sm flex-1 max-w-[100px]",children:"Yes"}),(0,a.jsx)("button",{onClick:()=>C(!1),className:"pixel-button bg-[#6b7280] hover:bg-[#4b5563] text-white px-6 py-2 text-sm flex-1 max-w-[100px]",children:"No"})]})]})}),(0,a.jsx)(y,{isOpen:z,onClose:()=>A(!1)})]}):null}function k(e){let{xpGained:t,coinsGained:s,sparksGained:n,levelUp:r,newLevel:o,onDismiss:l,onKeepFocusing:c,onGoHome:d}=e,[u,m]=(0,i.useState)(!0),{equippedCharacter:x,getCharacterImage:p}=v();return(console.log("SuccessMessage: Rendering with props:",{xpGained:t,coinsGained:s,sparksGained:n,levelUp:r,newLevel:o,isVisible:u}),u)?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[(0,a.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-1/3 z-10",children:(0,a.jsx)("img",{src:p(x),alt:"Tiny Adventurer",className:"w-32 h-40 sm:w-40 sm:h-48 pixel-art drop-shadow-lg",onError:e=>{e.currentTarget.style.display="none"}})}),(0,a.jsxs)("div",{className:"pixel-card p-6 sm:p-8 border-2 border-[#10b981] bg-[#064e3b] max-w-md w-full mx-4 relative z-20",children:[(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)("div",{className:"text-white text-xl sm:text-2xl font-bold mb-2",children:"\uD83C\uDF89 Session Complete! \uD83C\uDF89"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[r&&(0,a.jsxs)("div",{className:"text-[#fbbf24] font-bold text-center py-2",children:["\uD83D\uDE80 LEVEL UP! You are now Level ",o,"!"]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,a.jsxs)("div",{className:"pixel-card p-3 bg-[#1f2937] flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-[#fbbf24] text-sm mb-1",children:"XP"}),(0,a.jsxs)("div",{className:"text-white font-bold text-lg",children:["+",t]})]}),(0,a.jsxs)("div",{className:"pixel-card p-3 bg-[#1f2937] flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-[#fbbf24] text-sm mb-1",children:"Coins"}),(0,a.jsxs)("div",{className:"text-white font-bold text-lg",children:["+",s]})]}),n>0&&(0,a.jsxs)("div",{className:"pixel-card p-3 bg-[#1f2937] flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-[#fbbf24] text-sm mb-1",children:"Sparks"}),(0,a.jsxs)("div",{className:"text-white font-bold text-lg",children:["+",n]})]})]}),(0,a.jsxs)("div",{className:"text-center mt-6",children:[(0,a.jsx)("div",{className:"text-white text-lg font-bold mb-4",children:"Keep Focusing?"}),(0,a.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,a.jsx)("button",{onClick:c,className:"pixel-button bg-[#10b981] hover:bg-[#059669] text-white px-8 py-2 text-sm flex-1 max-w-[100px] flex items-center justify-center",children:"Yes"}),(0,a.jsx)("button",{onClick:d,className:"pixel-button bg-[#6b7280] hover:bg-[#4b5563] text-white px-8 py-2 text-sm flex-1 max-w-[100px] flex items-center justify-center",children:"No"})]})]})]})]})]})}):null}var N=e=>{let{src:t,volume:s=.4,loop:n=!0,autoPlay:r=!1,isSessionActive:o=!1,onLoad:l,onError:c}=e,d=(0,i.useRef)(null),[u,m]=(0,i.useState)(!1),[x,p]=(0,i.useState)(!1),[g,b]=(0,i.useState)(!1),{focusSessionVolume:f,isFocusSessionPlaying:v,setSessionActive:y}=h();return(0,i.useEffect)(()=>{b(!0)},[]),(0,i.useEffect)(()=>{if(!g)return;let e=d.current;if(!e)return;e.volume=f,e.loop=n;let t=()=>{p(!0),m(!1),null==l||l()},s=()=>{console.log("FocusSessionMusic: Audio started playing"),m(!0)},a=()=>{console.log("FocusSessionMusic: Audio paused"),m(!1)},i=()=>{null==c||c("Failed to load focus session audio file")};return e.addEventListener("loadeddata",t),e.addEventListener("play",s),e.addEventListener("pause",a),e.addEventListener("error",i),()=>{e.removeEventListener("loadeddata",t),e.removeEventListener("play",s),e.removeEventListener("pause",a),e.removeEventListener("error",i)}},[t,n,l,c,g]),(0,i.useEffect)(()=>{if(!g)return;let e=d.current;if(!e||!x)return;let t=o&&v;t&&!u?e.play().catch(()=>{console.log("Focus session music auto-play was blocked by browser")}):!t&&u&&e.pause()},[o,v,x,g]),(0,i.useEffect)(()=>{if(!g)return;let e=d.current;e&&x&&(console.log("FocusSessionMusic: State changed - isFocusSessionPlaying:",v,"isSessionActive:",o),v?o&&(console.log("FocusSessionMusic: Playing audio (focus session music enabled, session active)"),e.play().catch(()=>{console.log("Focus session music play was blocked by browser")})):(console.log("FocusSessionMusic: Pausing audio (focus session music disabled)"),e.pause()))},[v,o,x,g]),(0,i.useEffect)(()=>{d.current&&g&&(d.current.volume=f)},[f,g]),(0,a.jsx)("div",{className:"focus-session-audio-controls",children:(0,a.jsx)("audio",{ref:d,src:t,preload:"metadata"})})},j=e=>{let{isOpen:t,onClose:s,backgroundVolume:n,onBackgroundVolumeChange:r,isBackgroundPlaying:o,onBackgroundPlayPause:l,isSessionActive:c}=e,d=(0,i.useRef)(null);return((0,i.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&s()};return t&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t,s]),(0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s()};return t&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,s]),t)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{ref:d,className:"bg-[#1a1a2e] border-2 border-[#f2751a] rounded-lg p-6 max-w-sm w-full pixel-card",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-[#f2751a] font-bold text-lg",children:"\uD83C\uDFB5 Audio Controls"}),(0,a.jsx)("button",{onClick:s,className:"text-[#fbbf24] hover:text-white transition-colors text-xl",children:"✕"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-[#fbbf24] font-semibold",children:"Background Music"}),(0,a.jsx)("button",{onClick:()=>{console.log("AudioControlsPopup: Background play/pause clicked, current state:",o),l()},className:"px-3 py-1 bg-[#f2751a] hover:bg-[#e65a0a] transition-colors rounded text-white text-sm",children:o?"⏸️ Pause":"▶️ Play"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-[#fbbf24] text-sm",children:"\uD83D\uDD0A"}),(0,a.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:n,onChange:e=>r(parseFloat(e.target.value)),className:"flex-1 h-2 bg-[#2a2a3e] rounded-lg appearance-none cursor-pointer slider"}),(0,a.jsxs)("span",{className:"text-[#fbbf24] text-sm min-w-[3rem]",children:[Math.round(100*n),"%"]})]}),c&&(0,a.jsx)("p",{className:"text-gray-400 text-xs mt-2",children:"Background music is paused during active focus sessions"})]}),(0,a.jsx)("div",{className:"text-center text-[#fbbf24] text-sm",children:(0,a.jsx)("p",{children:"Audio controls are saved automatically"})})]})}):null};let S=e=>{let{isOpen:t,onClose:s}=e,{player:r,updatePlayer:o}=(0,l.g)(),{signOut:c}=(0,n.a)(),[d,u]=(0,i.useState)((null==r?void 0:r.display_name)||""),[m,x]=(0,i.useState)(!1),p=(0,i.useRef)(null);(0,i.useEffect)(()=>{u((null==r?void 0:r.display_name)||"")},[null==r?void 0:r.display_name]),(0,i.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&s()},a=e=>{"Escape"===e.key&&s()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",a)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",a)}},[t,s]);let h=async()=>{try{localStorage.removeItem("defeat-the-dragon-storage"),localStorage.removeItem("defeat-the-dragon-store"),await c(),s()}catch(e){console.error("Error signing out:",e)}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{ref:p,className:"bg-[#2d1b0e] border-2 border-[#8b4513] rounded-lg p-6 max-w-md w-full mx-4 pixel-art",style:{boxShadow:"0 0 20px rgba(139, 69, 19, 0.5)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-[#fbbf24]",children:"⚙️ Settings"}),(0,a.jsx)("button",{onClick:s,className:"text-[#fbbf24] hover:text-[#f2751a] text-xl font-bold",children:"✕"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#fbbf24] mb-3",children:"\uD83D\uDC64 Adventurer Name"}),m?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Enter your name...",className:"w-full px-3 py-2 bg-[#1a1a2e] border border-[#8b4513] rounded text-white placeholder-gray-400 focus:outline-none focus:border-[#f2751a]",maxLength:20,autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{d.trim()&&r&&(o({display_name:d.trim()}),x(!1))},disabled:!d.trim(),className:"px-3 py-1 bg-[#22c55e] hover:bg-[#16a34a] disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors rounded text-white text-sm flex-1",children:"Save"}),(0,a.jsx)("button",{onClick:()=>{u((null==r?void 0:r.display_name)||""),x(!1)},className:"px-3 py-1 bg-[#6b7280] hover:bg-[#4b5563] transition-colors rounded text-white text-sm flex-1",children:"Cancel"})]})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-white text-lg",children:(null==r?void 0:r.display_name)||"Adventurer"}),(0,a.jsx)("button",{onClick:()=>x(!0),className:"px-3 py-1 bg-[#f2751a] hover:bg-[#e65a0a] transition-colors rounded text-white text-sm",children:"Edit"})]})]}),(0,a.jsx)("div",{className:"border-t border-[#8b4513] my-6"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#fbbf24] mb-3",children:"\uD83D\uDEAA Account"}),(0,a.jsx)("button",{onClick:h,className:"w-full px-4 py-3 bg-[#dc2626] hover:bg-[#b91c1c] transition-colors rounded text-white font-semibold",children:"Sign Out"})]}),(0,a.jsx)("div",{className:"text-center text-sm text-gray-400",children:(0,a.jsx)("p",{children:"Your progress will be saved locally"})})]})}):null},T={character:[{id:"wizard",name:"Wizard",price:150,currency:"coins",description:"Powerful magic user",image:"/assets/sprites/wizard.png"},{id:"paladin",name:"Paladin",price:6,currency:"sparks",description:"Holy warrior with divine powers",image:"/assets/sprites/paladin.png"},{id:"rogue",name:"Rogue",price:150,currency:"coins",description:"Stealthy and agile fighter",image:"/assets/sprites/rogue.png"}],background:[{id:"tundra",name:"Tundra",price:3,currency:"sparks",description:"Frozen wilderness",image:"/assets/images/tundra-background.png"},{id:"underdark",name:"Underdark",price:100,currency:"coins",description:"Dark underground realm",image:"/assets/images/underdark-background.png"},{id:"dungeon",name:"Dungeon",price:100,currency:"coins",description:"Ancient stone corridors",image:"/assets/images/dungeon-background.png"}]};function P(e){let{isOpen:t,onClose:s}=e,[n,r]=(0,i.useState)("character"),o=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&s()},a=e=>{"Escape"===e.key&&s()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",a)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",a)}},[t,s]);let l=e=>{console.log("Purchasing ".concat(e.name," for ").concat(e.price," ").concat(e.currency))};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:(0,a.jsxs)("div",{ref:o,className:"bg-[#f5f5dc] border-4 border-[#8B4513] rounded-lg p-3 sm:p-6 w-full max-w-sm sm:max-w-2xl h-[90vh] sm:h-auto flex flex-col pixel-art",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3 sm:mb-6 flex-shrink-0",children:[(0,a.jsx)("h2",{className:"text-lg sm:text-2xl font-bold text-[#8B4513]",children:"\uD83C\uDFEA Shop"}),(0,a.jsx)("button",{onClick:s,className:"text-[#8B4513] hover:text-[#654321] text-xl sm:text-2xl font-bold",children:"\xd7"})]}),(0,a.jsx)("div",{className:"mb-3 sm:mb-6 flex-shrink-0",children:(0,a.jsx)("button",{onClick:()=>{console.log("Inspiration Boon purchase clicked"),alert("Inspiration Boon purchase coming soon! This will allow you to earn Sparks from successful focus sessions.")},className:"w-full bg-gradient-to-r from-[#FFD700] to-[#FFA500] border-2 border-[#8B4513] text-[#8B4513] font-bold py-2 sm:py-3 px-3 sm:px-4 rounded hover:from-[#FFA500] hover:to-[#FF8C00] transition-all duration-200 shadow-lg text-xs sm:text-sm",children:"✨ Inspiration Boon! Earn Sparks from Focus Sessions!"})}),(0,a.jsxs)("div",{className:"flex justify-center space-x-1 sm:space-x-2 mb-3 sm:mb-6 flex-shrink-0",children:[(0,a.jsx)("button",{onClick:()=>r("character"),className:"px-2 sm:px-4 py-1 sm:py-2 font-bold rounded border-2 transition-all text-xs sm:text-sm ".concat("character"===n?"bg-[#8B4513] text-[#f5f5dc] border-[#8B4513]":"bg-[#f5f5dc] text-[#8B4513] border-[#8B4513] hover:bg-[#e8e8d0]"),children:"\uD83E\uDDD9‍♂️ Character"}),(0,a.jsx)("button",{onClick:()=>r("background"),className:"px-2 sm:px-4 py-1 sm:py-2 font-bold rounded border-2 transition-all text-xs sm:text-sm ".concat("background"===n?"bg-[#8B4513] text-[#f5f5dc] border-[#8B4513]":"bg-[#f5f5dc] text-[#8B4513] border-[#8B4513] hover:bg-[#e8e8d0]"),children:"\uD83D\uDDBC️ Background"})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:T[n].map(e=>(0,a.jsxs)("div",{className:"aspect-square border-2 border-[#8B4513] rounded p-2 sm:p-3 transition-colors flex flex-col justify-between bg-[#e8e8d0] hover:bg-[#d8d8c0]",children:[(0,a.jsxs)("div",{className:"text-center flex-1 flex flex-col justify-center",children:[("character"===n||"background"===n)&&e.image?(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("img",{src:e.image,alt:e.name,className:"mx-auto object-contain ".concat("character"===n?"w-12 h-12 sm:w-16 sm:h-16":"w-16 h-12 sm:w-20 sm:h-16 rounded")})}):(0,a.jsxs)("div",{className:"text-lg sm:text-xl mb-1",children:["character"===n&&"\uD83E\uDDD9‍♂️","background"===n&&"\uD83D\uDDBC️"]}),(0,a.jsx)("h3",{className:"font-bold text-[#8B4513] text-xs sm:text-sm",children:e.name})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-1 mb-1",children:[(0,a.jsx)("span",{className:"text-[#8B4513] font-bold text-xs sm:text-sm",children:e.price}),(0,a.jsx)("span",{className:"text-xs sm:text-sm",children:"coins"===e.currency?"\uD83E\uDE99":"✨"})]}),(0,a.jsx)("button",{onClick:()=>l(e),className:"w-full bg-[#8B4513] text-[#f5f5dc] px-1 py-1 rounded font-bold hover:bg-[#654321] transition-colors text-xs",children:"Buy"})]})]},e.id))})}),(0,a.jsx)("div",{className:"mt-3 sm:mt-6 text-center flex-shrink-0",children:(0,a.jsx)("p",{className:"text-[#654321] text-xs sm:text-sm",children:"\uD83D\uDCA1 Tip: Get the Inspiration Boon to earn Sparks from your focus sessions!"})})]})}):null}let M=(0,b.Ue)()((0,f.tJ)((e,t)=>({equippedBackground:"forest",setEquippedBackground:t=>{e({equippedBackground:t})},getBackgroundImage:e=>{let t={forest:"/assets/images/forest-background.png",tundra:"/assets/images/tundra-background.png",underdark:"/assets/images/underdark-background.png",dungeon:"/assets/images/dungeon-background.png"};return t[e]||t.forest}}),{name:"background-store"})),E={character:[{id:"fighter",name:"Fighter",description:"Default warrior character",isOwned:!0,isEquipped:!1,category:"character",image:"/assets/sprites/fighter.png"},{id:"wizard",name:"Wizard",description:"Powerful magic user",isOwned:!0,isEquipped:!1,category:"character",image:"/assets/sprites/wizard.png"},{id:"paladin",name:"Paladin",description:"Holy warrior with divine powers",isOwned:!0,isEquipped:!1,category:"character",image:"/assets/sprites/paladin.png"},{id:"rogue",name:"Rogue",description:"Stealthy and agile fighter",isOwned:!0,isEquipped:!1,category:"character",image:"/assets/sprites/rogue.png"}],background:[{id:"forest",name:"Forest",description:"Default forest scene",isOwned:!0,isEquipped:!1,category:"background",image:"/assets/images/forest-background.png"},{id:"tundra",name:"Tundra",description:"Frozen wilderness",isOwned:!0,isEquipped:!1,category:"background",image:"/assets/images/tundra-background.png"},{id:"underdark",name:"Underdark",description:"Dark underground realm",isOwned:!0,isEquipped:!1,category:"background",image:"/assets/images/underdark-background.png"},{id:"dungeon",name:"Dungeon",description:"Ancient stone corridors",isOwned:!0,isEquipped:!1,category:"background",image:"/assets/images/dungeon-background.png"}]};function D(e){let{isOpen:t,onClose:s}=e,[n,r]=(0,i.useState)("character"),[o,l]=(0,i.useState)({character:"fighter",background:"bg_default"}),c=(0,i.useRef)(null),{equippedCharacter:d,setEquippedCharacter:u}=v(),{equippedBackground:m,setEquippedBackground:x}=M();(0,i.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&s()},a=e=>{"Escape"===e.key&&s()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",a)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",a)}},[t,s]);let p=e=>{e.isOwned&&("character"===e.category?u(e.id):"background"===e.category&&x(e.id),l(t=>({...t,[e.category]:e.id})),console.log("Equipped ".concat(e.name," for ").concat(e.category)))};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:(0,a.jsxs)("div",{ref:c,className:"bg-[#f5f5dc] border-4 border-[#8B4513] rounded-lg p-3 sm:p-6 w-full max-w-sm sm:max-w-2xl h-[90vh] sm:h-auto flex flex-col pixel-art",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3 sm:mb-6 flex-shrink-0",children:[(0,a.jsx)("h2",{className:"text-lg sm:text-2xl font-bold text-[#8B4513]",children:"\uD83C\uDF92 Inventory"}),(0,a.jsx)("button",{onClick:s,className:"text-[#8B4513] hover:text-[#654321] text-xl sm:text-2xl font-bold",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-1 sm:space-x-2 mb-3 sm:mb-6 flex-shrink-0",children:[(0,a.jsx)("button",{onClick:()=>r("character"),className:"px-2 sm:px-4 py-1 sm:py-2 font-bold rounded border-2 transition-all text-xs sm:text-sm ".concat("character"===n?"bg-[#8B4513] text-[#f5f5dc] border-[#8B4513]":"bg-[#f5f5dc] text-[#8B4513] border-[#8B4513] hover:bg-[#e8e8d0]"),children:"\uD83E\uDDD9‍♂️ Character"}),(0,a.jsx)("button",{onClick:()=>r("background"),className:"px-2 sm:px-4 py-1 sm:py-2 font-bold rounded border-2 transition-all text-xs sm:text-sm ".concat("background"===n?"bg-[#8B4513] text-[#f5f5dc] border-[#8B4513]":"bg-[#f5f5dc] text-[#8B4513] border-[#8B4513] hover:bg-[#e8e8d0]"),children:"\uD83D\uDDBC️ Background"})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:E[n].filter(e=>e.isOwned).map(e=>(0,a.jsxs)("div",{className:"aspect-square border-2 rounded p-2 sm:p-3 transition-colors flex flex-col justify-between ".concat("character"===e.category&&e.id===d||"background"===e.category&&e.id===m||e.isEquipped?"bg-[#8B4513] border-[#8B4513] shadow-lg":"bg-[#e8e8d0] border-[#8B4513] hover:bg-[#d8d8c0]"),children:[(0,a.jsxs)("div",{className:"text-center flex-1 flex flex-col justify-center",children:[("character"===n||"background"===n)&&e.image?(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("img",{src:e.image,alt:e.name,className:"mx-auto object-contain ".concat("character"===n?"w-12 h-12 sm:w-16 sm:h-16":"w-16 h-12 sm:w-20 sm:h-16 rounded")})}):(0,a.jsxs)("div",{className:"text-lg sm:text-xl mb-1",children:["character"===n&&"\uD83E\uDDD9‍♂️","background"===n&&"\uD83D\uDDBC️"]}),(0,a.jsx)("h3",{className:"font-bold text-xs sm:text-sm ".concat("character"===e.category&&e.id===d||"background"===e.category&&e.id===m||e.isEquipped?"text-[#f5f5dc]":"text-[#8B4513]"),children:e.name})]}),(0,a.jsxs)("div",{className:"text-center",children:[!("character"===e.category&&e.id===d||"background"===e.category&&e.id===m||e.isEquipped)&&(0,a.jsx)("button",{onClick:()=>p(e),className:"w-full bg-[#8B4513] text-[#f5f5dc] px-1 py-1 rounded font-bold hover:bg-[#654321] transition-colors text-xs",children:"Equip"}),("character"===e.category&&e.id===d||"background"===e.category&&e.id===m||e.isEquipped)&&(0,a.jsx)("span",{className:"text-[#f5f5dc] text-xs font-bold",children:"✓ Equipped"})]})]},e.id))})}),(0,a.jsx)("div",{className:"mt-3 sm:mt-6 text-center flex-shrink-0",children:(0,a.jsx)("p",{className:"text-[#654321] text-xs sm:text-sm",children:"\uD83D\uDCA1 Tip: Visit the shop to unlock more items and customize your experience!"})})]})}):null}let C=["Sharpening my courage… and this butter knife.","Discipline is a spell I cast every morning.","Quiet steps, loud wins.","Hey, partner—guard the calm, I'll guard the quest.","Every minute I focus, the dragon sneezes a little.","Treasure maps are just to-do lists with flair.","One breath in, one task down.","XP is just patience wearing a cape.","Sparks like these? Earned, not found.","I packed snacks and resolve—mostly resolve.","A tidy mind swings straighter than any sword.","Today's boss: distractions. Weak to silence.","I'm not tiny—I'm concentrated.","Footwork quiet, heartbeat steady.","The dungeon of procrastination has endless corridors. I brought a lantern.","Discipline is my favorite rare drop.","We train small to win big.","Another pebble on the path to the peak.","Focus first, fireworks later.","The dragon fears checkmarks.","Steel your will; I'll steel the dagger.","Routine is just fast travel for progress.","Shh—listening for the next right step.","Mobs respawn. Momentum shouldn't.","A calm mind is my strongest stat.","I can hear the treasure chest clicking 'almost.'","Hero tip: bravery looks a lot like finishing.","We don't chase motivation; we schedule it.","One quiet session. One louder life.","Even dragons blink. That's our window.","Sparks love discipline more than luck.","If focus had footsteps, you'd hear marching.","Quest log says: do the next small thing.","I polished my shield and my priorities.","Adventure begins when excuses end.","The map is messy; our steps don't have to be.","Sword in hand, phone asleep—perfect.","Tiny heroes take giant minutes.","I put bravery on repeat.","Progress tastes like warm bread and effort.","The dragon whispers 'later'; we answer 'now.'","I'm stacking quiet like coins.","Discipline isn't heavy when you lift it daily.","We'll out-focus the flame.","I'll handle the mobs; you handle the stillness.","Patience: the crit hit of real life.","I aim my arrows where attention points.","The questline of today: start, stick, finish.","Small stride, sure stride, victory stride.","Our best loot? Habits we actually use.","Eyes on the path, heart on the prize.","We're not just defeating a dragon—we're becoming the hero who can.","Maps can fib; minutes never do.","I keep the torch; you keep the hush.","Quiet turns to coins faster than crits.","The timer is our drum. March with me.","A steady breath beats a shiny sword.","Focus is just bravery sitting still.","I packed patience, on purpose.","Every checkmark is a tiny roar back.","Let the phone sleep—let the hero wake.","We loot time and forge progress.","The path clears when the mind does.","Small wins stack like bricks—castle soon.","I'm saving my crit for distractions.","Lantern bright, excuses light.","Grinding XP? More like polishing today.","One minute more. That's the secret door.","Focus casts shield on everything else.","The calm is our companion.","Aim true, even at tiny tasks.","Sparks follow footsteps, not wishes.","I brought resolve; it fits every dungeon.","Silence is my favorite buff.","We don't rush— we repeat.","Dragons hate tidy lists.","Let the world scroll; we'll stroll.","Mind steady, hands steady, story steady.","I'll guard the quest if you guard the quiet.","Routine is the rope bridge—cross it daily.","The treasure is attention, not the chest.","Hold the stillness; I'll hold the line.","Every 'now' is a secret shortcut.","Focus first, flair later.","We train the minute, the minute trains us.","Turn effort into echo: done, done, done.","When I'm ready, the path is ready.","Defeat the dragon? Easy—one calm session at a time."];function z(e){let{isVisible:t,triggerQuoteChangeCount:s}=e,[n,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),c=()=>{let e=Math.floor(Math.random()*C.length);return C[e]};return((0,i.useEffect)(()=>{if(t&&!o){let e=setTimeout(()=>{r(c()),l(!0)},1e3);return()=>clearTimeout(e)}!t&&o&&l(!1)},[t,o]),(0,i.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{r(c())},6e4);return()=>clearInterval(e)},[o]),(0,i.useEffect)(()=>{t&&r(c())},[]),(0,i.useEffect)(()=>{t&&s>0&&r(c())},[s,t]),o&&n)?(0,a.jsx)("div",{className:"absolute bottom-32 sm:bottom-36 left-1/2 transform -translate-x-1/2 z-20 max-w-sm sm:max-w-md lg:max-w-lg",children:(0,a.jsxs)("div",{className:"relative bg-[#f5f5dc] border-2 border-[#8B4513] rounded-lg p-3 sm:p-4 shadow-lg animate-fade-in min-w-[280px] sm:min-w-[320px]",children:[(0,a.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-[#8B4513]"}),(0,a.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-3 border-r-3 border-t-3 border-transparent border-t-[#f5f5dc] mt-0.5"}),(0,a.jsxs)("p",{className:"text-[#8B4513] text-xs sm:text-sm font-medium leading-relaxed text-center whitespace-normal",children:['"',n,'"']})]})}):null}function A(){let{player:e,sessionProgress:t,startSession:s,completeSession:n,loadPlayerData:r}=(0,l.g)(),{backgroundVolume:o,isBackgroundPlaying:c,isSessionActive:u,setBackgroundVolume:m,toggleBackgroundPlayPause:p,setSessionActive:g}=h(),[b,f]=(0,i.useState)(!1),[y,T]=(0,i.useState)(!1),[E,C]=(0,i.useState)(!1),[A,L]=(0,i.useState)(!1),[F,_]=(0,i.useState)(!1),[X,B]=(0,i.useState)(null),[I,R]=(0,i.useState)(0),{equippedCharacter:q,getCharacterImage:O}=v(),{equippedBackground:W,getBackgroundImage:V}=M();(0,i.useEffect)(()=>{x(),r()},[r]),(0,i.useEffect)(()=>{u!==t.isActive&&g(t.isActive)},[t.isActive,u,g]);let G=async(e,t)=>{console.log("GameDashboard: handleSessionStart called");try{await s(e,t),console.log("GameDashboard: Session started successfully"),_(!1)}catch(e){console.error("GameDashboard: Failed to start session:",e)}},U=async()=>{console.log("GameDashboard: handleSessionComplete called");try{var e,t;console.log("GameDashboard: About to call completeSession...");let s=await n("success");console.log("GameDashboard: Session completed successfully"),console.log("GameDashboard: Setting session result"),B(s),_(!1),e=s.xp_gained,t=s.coins_gained,"granted"===Notification.permission&&new Notification("\uD83C\uDF89 Session Complete!",{body:"You gained ".concat(e," XP and ").concat(t," coins!"),icon:"/icons/icon-144x144.png",badge:"/icons/icon-144x144.png",tag:"session-complete",requireInteraction:!1}),console.log("GameDashboard: handleSessionComplete finished successfully")}catch(e){console.error("GameDashboard: Failed to complete session:",e)}},H=async()=>{console.log("GameDashboard: handleSessionFail called");try{console.log("GameDashboard: About to call completeSession with fail..."),await n("fail"),console.log("GameDashboard: Session failed"),_(!1)}catch(e){console.error("GameDashboard: Failed to fail session:",e)}};return e?(0,a.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)(N,{src:"/assets/audio/focus-session-music.mp3",volume:.4,loop:!0,isSessionActive:t.isActive,onLoad:()=>console.log("Focus session music loaded"),onError:e=>console.error("Focus session music error:",e)}),(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(V(W),")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,a.jsxs)("div",{className:"relative z-10 min-h-screen flex flex-col",children:[!t.isActive&&!F&&!X&&(0,a.jsxs)("div",{className:"flex justify-between items-start p-3 sm:p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-1 sm:space-y-2",children:[(0,a.jsxs)("div",{className:"flex space-x-1 sm:space-x-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:"/assets/ui/level-card.png",alt:"Level",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-[#8B4513] font-bold text-xs sm:text-sm drop-shadow-sm",children:e.level})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:"/assets/ui/name-card.png",alt:"Name",className:"w-36 h-8 sm:w-40 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-start px-2 sm:px-3 pointer-events-none overflow-hidden",children:(0,a.jsx)("span",{className:"text-[#8B4513] font-bold text-[9px] sm:text-[11px] drop-shadow-sm whitespace-nowrap truncate",children:(e.display_name||"Adventurer").substring(0,20)})})]})]}),(0,a.jsxs)("div",{className:"flex space-x-1 sm:space-x-2",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("img",{src:"/assets/ui/gold-icon.png",alt:"Gold Icon",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:"/assets/ui/gold-card.png",alt:"Gold",className:"w-16 h-8 sm:w-18 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none overflow-hidden",children:(0,a.jsx)("span",{className:"text-[#8B4513] font-bold text-[10px] sm:text-[12px] drop-shadow-sm truncate",children:e.coins.toString().padStart(4,"0")})})]})]}),(0,a.jsxs)("div",{className:"flex space-x-1 sm:space-x-2",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("img",{src:"/assets/ui/sparks-icon.png",alt:"Sparks Icon",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:"/assets/ui/sparks-card.png",alt:"Sparks",className:"w-16 h-8 sm:w-18 sm:h-10 pixel-art",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none overflow-hidden",children:(0,a.jsx)("span",{className:"text-[#8B4513] font-bold text-[10px] sm:text-[12px] drop-shadow-sm truncate",children:e.sparks.toString().padStart(4,"0")})})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1 sm:space-y-2",children:[(0,a.jsx)("img",{src:"/assets/icons/settings.png",alt:"Settings",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art cursor-pointer hover:opacity-80 transition-opacity drop-shadow-lg",onClick:()=>T(!0)}),(0,a.jsx)("img",{src:"/assets/icons/sound.png",alt:"Sound",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art cursor-pointer hover:opacity-80 transition-opacity drop-shadow-lg",onClick:()=>f(!0)}),(0,a.jsx)("img",{src:"/assets/icons/shop.png",alt:"Shop",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art cursor-pointer hover:opacity-80 transition-opacity drop-shadow-lg",onClick:()=>C(!0)}),(0,a.jsx)("img",{src:"/assets/icons/inventory.png",alt:"Inventory",className:"w-8 h-8 sm:w-10 sm:h-10 pixel-art cursor-pointer hover:opacity-80 transition-opacity drop-shadow-lg",onClick:()=>L(!0)})]})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center relative px-4 ".concat(F||t.isActive||X?"hidden":""),children:(0,a.jsxs)("div",{className:"relative z-10 transform translate-y-8 sm:translate-y-12",children:[(0,a.jsx)("img",{src:O(q),alt:"Tiny Adventurer",className:"w-28 h-32 sm:w-32 sm:h-36 pixel-art drop-shadow-lg object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{R(e=>e+1)},onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)(z,{isVisible:!F&&!t.isActive&&!X,triggerQuoteChangeCount:I})]})}),(0,a.jsx)("div",{className:"p-3 sm:p-4 ".concat(F||X?"hidden":""),children:t.isActive?(0,a.jsx)(w,{onSessionComplete:U,onSessionFail:H}):(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"w-full max-w-[280px] sm:max-w-[320px] mx-auto -mt-4 sm:-mt-6",children:[(0,a.jsx)("img",{src:"/assets/ui/focus-button.png",alt:"FOCUS",className:"w-full h-auto pixel-art cursor-pointer hover:opacity-90 transition-opacity drop-shadow-lg",onClick:()=>_(!0),onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,a.jsx)("button",{onClick:()=>_(!0),className:"w-full max-w-[280px] sm:max-w-[320px] mx-auto bg-[#f5f5dc] border-4 border-[#8B4513] text-[#8B4513] font-bold text-base sm:text-lg py-2 sm:py-3 px-4 sm:px-6 hover:bg-[#e8e8d0] transition-colors shadow-lg hidden",children:"FOCUS"})]})})}),X&&(0,a.jsx)(k,{xpGained:X.xp_gained,coinsGained:X.coins_gained,sparksGained:X.sparks_gained,levelUp:X.level_up,newLevel:X.new_level,onDismiss:()=>{B(null)},onKeepFocusing:()=>{B(null),_(!0)},onGoHome:()=>{B(null)}})]}),F&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-6 sm:p-8",children:(0,a.jsx)("div",{className:"w-full max-w-md",children:(0,a.jsx)(d,{onSessionStart:G,onSessionCancel:()=>{_(!1)}})})}),(0,a.jsx)(j,{isOpen:b,onClose:()=>f(!1),backgroundVolume:o,onBackgroundVolumeChange:m,isBackgroundPlaying:c,onBackgroundPlayPause:p,isSessionActive:u}),(0,a.jsx)(S,{isOpen:y,onClose:()=>T(!1)}),(0,a.jsx)(P,{isOpen:E,onClose:()=>C(!1)}),(0,a.jsx)(D,{isOpen:A,onClose:()=>L(!1)})]}):(0,a.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(V(W),")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,a.jsx)("div",{className:"relative z-10 min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"pixel-card p-8 text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-4",children:"⚔️"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-[#f2751a] mb-2",children:"Loading Character..."}),(0,a.jsx)("p",{className:"text-[#fbbf24]",children:"Preparing your adventure..."})]})})]})}var L=e=>{let{src:t,volume:s=.5,loop:n=!0,autoPlay:r=!1,onLoad:o,onError:l}=e,c=(0,i.useRef)(null),[d,u]=(0,i.useState)(!1),[m,x]=(0,i.useState)(!1),{backgroundVolume:p,isBackgroundPlaying:g,setBackgroundPlaying:b,isSessionActive:f}=h();return(0,i.useEffect)(()=>{x(!0)},[]),(0,i.useEffect)(()=>{if(!m)return;let e=c.current;if(!e)return;e.volume=p,e.loop=n;let t=()=>{u(!1),b(!1),null==o||o()},s=()=>{console.log("BackgroundMusic: Audio started playing"),u(!0)},a=()=>{console.log("BackgroundMusic: Audio paused"),u(!1)},i=()=>{null==l||l("Failed to load audio file")};return e.addEventListener("loadeddata",t),e.addEventListener("play",s),e.addEventListener("pause",a),e.addEventListener("error",i),r&&m&&e.play().catch(()=>{console.log("Auto-play was blocked by browser")}),()=>{e.removeEventListener("loadeddata",t),e.removeEventListener("play",s),e.removeEventListener("pause",a),e.removeEventListener("error",i)}},[t,n,r,o,l,m,p,b]),(0,i.useEffect)(()=>{c.current&&m&&(c.current.volume=p)},[p,m]),(0,i.useEffect)(()=>{if(!m)return;let e=c.current;if(!e)return;let t=g&&!f;t&&!d?e.play().catch(()=>{console.log("Background music play was blocked by browser")}):!t&&d&&e.pause()},[g,f,d,m]),(0,i.useEffect)(()=>{if(!m)return;let e=c.current;e&&(console.log("BackgroundMusic: State changed - isBackgroundPlaying:",g,"isSessionActive:",f),g?f||(console.log("BackgroundMusic: Playing audio (background music enabled, no session)"),e.play().catch(()=>{console.log("Background music play was blocked by browser")})):(console.log("BackgroundMusic: Pausing audio (background music disabled)"),e.pause()))},[g,f,m]),(0,a.jsx)("div",{className:"audio-controls",children:(0,a.jsx)("audio",{ref:c,src:t,preload:"metadata"})})};function F(){let{user:e,loading:t}=(0,n.a)(),[s,l]=(0,i.useState)("login");return t?(0,a.jsxs)("main",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/assets/images/forest-background.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,a.jsx)("div",{className:"relative z-10 min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-4 border-[#f2751a] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg text-white drop-shadow-lg",children:"Loading..."})]})})]}):e?(0,a.jsxs)(g,{children:[(0,a.jsx)(L,{src:"/assets/audio/background-music.mp3",volume:.3,loop:!0,autoPlay:!0,onLoad:()=>console.log("Background music loaded"),onError:e=>console.error("Background music error:",e)}),(0,a.jsx)(N,{src:"/assets/audio/focus-session-music.mp3",volume:.4,loop:!0,autoPlay:!1,onLoad:()=>console.log("Focus session music loaded"),onError:e=>console.error("Focus session music error:",e)}),(0,a.jsx)(A,{})]}):(0,a.jsx)(g,{children:(0,a.jsxs)("main",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)(L,{src:"/assets/audio/background-music.mp3",volume:.2,loop:!0,autoPlay:!0,onLoad:()=>console.log("Background music loaded"),onError:e=>console.error("Background music error:",e)}),(0,a.jsx)(N,{src:"/assets/audio/focus-session-music.mp3",volume:.4,loop:!0,autoPlay:!1,onLoad:()=>console.log("Focus session music loaded"),onError:e=>console.error("Focus session music error:",e)}),(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/assets/images/forest-background.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,a.jsxs)("div",{className:"relative z-10 min-h-screen flex flex-col items-center justify-center px-4",children:[(0,a.jsx)("div",{className:"w-full max-w-md",children:"login"===s?(0,a.jsx)(r,{}):(0,a.jsx)(o,{})}),(0,a.jsx)("div",{className:"mt-6 text-center",children:(0,a.jsx)("button",{onClick:()=>l("login"===s?"signup":"login"),className:"text-[#fbbf24] hover:text-white transition-colors text-sm underline",children:"login"===s?"Don't have an account? Create Account":"Already have an account? Sign In"})})]})]})})}},2282:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.actionMetadata=void 0,t.actionForMinutes=function(e){let t=Math.max(5,Math.min(120,Math.round(e)));return t<=15?"Train":t<=30?"Eat":t<=45?"Learn":t<=60?"Bathe":t<=75?"Sleep":t<=90?"Maintain":t<=105?"Fight":"Adventure"},t.getValidDurations=function(){let e=[];for(let t=5;t<=120;t+=5)e.push(t);return e},t.isValidDuration=function(e){return e>=5&&e<=120&&e%5==0},t.actionMetadata={Train:{emoji:"⚔️",label:"Train",description:"Practice combat skills and build strength",background:"campfire",idleAnimation:"training"},Eat:{emoji:"\uD83C\uDF4E",label:"Eat",description:"Restore energy with a hearty meal",background:"kitchen",idleAnimation:"eating"},Learn:{emoji:"\uD83E\uDDE0",label:"Learn",description:"Study ancient knowledge and spells",background:"library",idleAnimation:"studying"},Bathe:{emoji:"\uD83D\uDEC1",label:"Bathe",description:"Clean and refresh your spirit",background:"bathhouse",idleAnimation:"bathing"},Sleep:{emoji:"\uD83D\uDE34",label:"Sleep",description:"Rest and recover your strength",background:"bedroll",idleAnimation:"sleeping"},Maintain:{emoji:"\uD83D\uDD27",label:"Maintain",description:"Care for your equipment and gear",background:"workshop",idleAnimation:"maintaining"},Fight:{emoji:"⚡",label:"Fight",description:"Engage in intense combat training",background:"arena",idleAnimation:"fighting"},Adventure:{emoji:"\uD83D\uDDFA️",label:"Adventure",description:"Explore unknown territories",background:"cave_mouth",idleAnimation:"exploring"}}},4764:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xpProgressToNextLevel=t.xpForNextLevel=t.computeLevel=t.computeSparks=t.computeCoins=t.computeXP=void 0;let s={5:{xpMin:5,xpMax:6,goldMin:3,goldMax:3,sparks:0},10:{xpMin:10,xpMax:12,goldMin:6,goldMax:7,sparks:0},15:{xpMin:16,xpMax:18,goldMin:9,goldMax:10,sparks:1},20:{xpMin:22,xpMax:25,goldMin:13,goldMax:15,sparks:1},25:{xpMin:28,xpMax:32,goldMin:16,goldMax:19,sparks:1},30:{xpMin:34,xpMax:39,goldMin:20,goldMax:23,sparks:2},35:{xpMin:41,xpMax:47,goldMin:24,goldMax:28,sparks:2},40:{xpMin:48,xpMax:55,goldMin:28,goldMax:33,sparks:2},45:{xpMin:55,xpMax:63,goldMin:33,goldMax:37,sparks:3},50:{xpMin:62,xpMax:71,goldMin:37,goldMax:42,sparks:3},55:{xpMin:70,xpMax:80,goldMin:42,goldMax:48,sparks:3},60:{xpMin:78,xpMax:89,goldMin:46,goldMax:53,sparks:4},65:{xpMin:86,xpMax:98,goldMin:51,goldMax:58,sparks:4},70:{xpMin:94,xpMax:108,goldMin:56,goldMax:64,sparks:4},75:{xpMin:103,xpMax:118,goldMin:61,goldMax:70,sparks:5},80:{xpMin:112,xpMax:128,goldMin:67,goldMax:76,sparks:5},85:{xpMin:121,xpMax:138,goldMin:72,goldMax:82,sparks:5},90:{xpMin:130,xpMax:149,goldMin:78,goldMax:89,sparks:6},95:{xpMin:140,xpMax:160,goldMin:84,goldMax:96,sparks:6},100:{xpMin:150,xpMax:171,goldMin:90,goldMax:102,sparks:6},105:{xpMin:158,xpMax:180,goldMin:94,goldMax:108,sparks:7},110:{xpMin:165,xpMax:188,goldMin:99,goldMax:112,sparks:7},115:{xpMin:172,xpMax:197,goldMin:103,goldMax:118,sparks:7},120:{xpMin:180,xpMax:205,goldMin:108,goldMax:123,sparks:8}},a=e=>{let t=Object.keys(s).map(Number).sort((e,t)=>e-t),a=t[0];for(let s of t)if(e>=s)a=s;else break;return s[a]},i=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;t.computeXP=(e,t,s)=>{let r=a(e);return Math.round(i(r.xpMin,r.xpMax)*(n[t]||1)*(1+.02*Math.min(s,7)))};let n={Train:1,Eat:.5,Learn:1.05,Bathe:.4,Sleep:.25,Maintain:.8,Fight:1.2,Adventure:1.15};t.computeCoins=e=>{let t=a(e);return i(t.goldMin,t.goldMax)},t.computeSparks=(e,t)=>t?a(e).sparks:0;let r={1:{xpToNext:50,cumulativeXP:17},2:{xpToNext:83,cumulativeXP:67},3:{xpToNext:117,cumulativeXP:150},4:{xpToNext:150,cumulativeXP:267},5:{xpToNext:183,cumulativeXP:417},6:{xpToNext:217,cumulativeXP:600},7:{xpToNext:250,cumulativeXP:817},8:{xpToNext:283,cumulativeXP:1067},9:{xpToNext:317,cumulativeXP:1350},10:{xpToNext:350,cumulativeXP:1667},11:{xpToNext:383,cumulativeXP:2017},12:{xpToNext:417,cumulativeXP:2400},13:{xpToNext:450,cumulativeXP:2817},14:{xpToNext:483,cumulativeXP:3267},15:{xpToNext:517,cumulativeXP:3750},16:{xpToNext:550,cumulativeXP:4267},17:{xpToNext:583,cumulativeXP:4817},18:{xpToNext:617,cumulativeXP:5400},19:{xpToNext:650,cumulativeXP:6017},20:{xpToNext:683,cumulativeXP:6667},21:{xpToNext:717,cumulativeXP:7350},22:{xpToNext:750,cumulativeXP:8067},23:{xpToNext:783,cumulativeXP:8817},24:{xpToNext:817,cumulativeXP:9600},25:{xpToNext:850,cumulativeXP:10417},26:{xpToNext:883,cumulativeXP:11267},27:{xpToNext:917,cumulativeXP:12150},28:{xpToNext:950,cumulativeXP:13067},29:{xpToNext:983,cumulativeXP:14017},30:{xpToNext:1017,cumulativeXP:15e3},31:{xpToNext:1050,cumulativeXP:16017},32:{xpToNext:1083,cumulativeXP:17067},33:{xpToNext:1117,cumulativeXP:18150},34:{xpToNext:1150,cumulativeXP:19267},35:{xpToNext:1183,cumulativeXP:20417},36:{xpToNext:1217,cumulativeXP:21600},37:{xpToNext:1250,cumulativeXP:22817},38:{xpToNext:1283,cumulativeXP:24067},39:{xpToNext:1317,cumulativeXP:25350},40:{xpToNext:1350,cumulativeXP:26667},41:{xpToNext:1383,cumulativeXP:28017},42:{xpToNext:1417,cumulativeXP:29400},43:{xpToNext:1450,cumulativeXP:30817},44:{xpToNext:1483,cumulativeXP:32267},45:{xpToNext:1517,cumulativeXP:33750},46:{xpToNext:1550,cumulativeXP:35267},47:{xpToNext:1583,cumulativeXP:36817},48:{xpToNext:1617,cumulativeXP:38400},49:{xpToNext:1650,cumulativeXP:40017},50:{xpToNext:1683,cumulativeXP:41667},51:{xpToNext:1717,cumulativeXP:43350},52:{xpToNext:1750,cumulativeXP:45067},53:{xpToNext:1783,cumulativeXP:46817},54:{xpToNext:1817,cumulativeXP:48600},55:{xpToNext:1850,cumulativeXP:50417},56:{xpToNext:1883,cumulativeXP:52267},57:{xpToNext:1917,cumulativeXP:54150},58:{xpToNext:1950,cumulativeXP:56067},59:{xpToNext:1983,cumulativeXP:58017},60:{xpToNext:2017,cumulativeXP:6e4},61:{xpToNext:2050,cumulativeXP:62017},62:{xpToNext:2083,cumulativeXP:64067},63:{xpToNext:2117,cumulativeXP:66150},64:{xpToNext:2150,cumulativeXP:68267},65:{xpToNext:2183,cumulativeXP:70417},66:{xpToNext:2217,cumulativeXP:72600},67:{xpToNext:2250,cumulativeXP:74817},68:{xpToNext:2283,cumulativeXP:77067},69:{xpToNext:2317,cumulativeXP:79350},70:{xpToNext:2350,cumulativeXP:81667},71:{xpToNext:2383,cumulativeXP:84017},72:{xpToNext:2417,cumulativeXP:86400},73:{xpToNext:2450,cumulativeXP:88817},74:{xpToNext:2483,cumulativeXP:91267},75:{xpToNext:2517,cumulativeXP:93750},76:{xpToNext:2550,cumulativeXP:96267},77:{xpToNext:2583,cumulativeXP:98817},78:{xpToNext:2617,cumulativeXP:101400},79:{xpToNext:2650,cumulativeXP:104017},80:{xpToNext:2683,cumulativeXP:106667},81:{xpToNext:2717,cumulativeXP:109350},82:{xpToNext:2750,cumulativeXP:112067},83:{xpToNext:2783,cumulativeXP:114817},84:{xpToNext:2817,cumulativeXP:117600},85:{xpToNext:2850,cumulativeXP:120417},86:{xpToNext:2883,cumulativeXP:123267},87:{xpToNext:2917,cumulativeXP:126150},88:{xpToNext:2950,cumulativeXP:129067},89:{xpToNext:2983,cumulativeXP:132017},90:{xpToNext:3017,cumulativeXP:135e3},91:{xpToNext:3050,cumulativeXP:138017},92:{xpToNext:3083,cumulativeXP:141067},93:{xpToNext:3117,cumulativeXP:144150},94:{xpToNext:3150,cumulativeXP:147267},95:{xpToNext:3183,cumulativeXP:150417},96:{xpToNext:3217,cumulativeXP:153600},97:{xpToNext:3250,cumulativeXP:156817},98:{xpToNext:3283,cumulativeXP:160067},99:{xpToNext:3317,cumulativeXP:163350}};t.computeLevel=e=>{for(let t=99;t>=1;t--)if(e>=r[t].cumulativeXP)return t;return 1},t.xpForNextLevel=e=>e>=99?0:r[e].xpToNext,t.xpProgressToNextLevel=e=>{let s=(0,t.computeLevel)(e);if(s>=99)return 1;let a=r[s].cumulativeXP;return Math.max(0,Math.min(1,(e-a)/(r[s+1].cumulativeXP-a)))}},2277:function(e,t,s){"use strict";var a=Object.create?function(e,t,s,a){void 0===a&&(a=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,a,i)}:function(e,t,s,a){void 0===a&&(a=s),e[a]=t[s]},i=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||a(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),i(s(4764),t),i(s(3202),t),i(s(227),t),i(s(2282),t)},3202:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rollLoot=t.SAMPLE_LOOT_ITEMS=t.LootRNG=t.LootType=t.LootRarity=void 0;let a=s(8859);t.LootRarity=a.z.enum(["C","U","R","SR","SSR"]),t.LootType=a.z.enum(["cosmetic","pet","trinket"]);let i={C:55,U:25,R:12,SR:6,SSR:2};class n{next(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280}rollRarity(e,t){let s=Math.min(e/25*.05,.25),a=t?.1:0,n=this.next(),r=0,o={...i};a>0&&(o.R+=.3*a,o.SR+=.4*a,o.SSR+=.3*a,o.C-=a),o.U+=.3*s,o.R+=.4*s,o.SR+=.2*s,o.SSR+=.1*s,o.C-=s;let l=Object.values(o).reduce((e,t)=>e+t,0);for(let[e,t]of(Object.keys(o).forEach(e=>{o[e]=o[e]/l*100}),Object.entries(o)))if(n<=(r+=t)/100)return e;return"C"}rollItem(e,t){let s=t.filter(t=>t.rarity===e);if(0===s.length)return null;let a=Math.floor(this.next()*s.length);return s[a]}constructor(e){this.seed=e.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)&4294967295,0)}}t.LootRNG=n,t.SAMPLE_LOOT_ITEMS=[{sku:"trinket_01",name:"Lucky Coin",rarity:"C",type:"trinket",minLevel:1},{sku:"trinket_02",name:"Focus Crystal",rarity:"C",type:"trinket",minLevel:1},{sku:"trinket_03",name:"Study Stone",rarity:"C",type:"trinket",minLevel:1},{sku:"decor_01",name:"Scholar's Lamp",rarity:"U",type:"cosmetic",minLevel:1},{sku:"decor_02",name:"Focus Fountain",rarity:"U",type:"cosmetic",minLevel:1},{sku:"decor_03",name:"Wisdom Tree",rarity:"U",type:"cosmetic",minLevel:1},{sku:"skin_frag_01",name:"Hero's Cape Fragment",rarity:"R",type:"cosmetic",minLevel:1},{sku:"skin_frag_02",name:"Mage's Robe Fragment",rarity:"R",type:"cosmetic",minLevel:1},{sku:"skin_frag_03",name:"Warrior's Armor Fragment",rarity:"R",type:"cosmetic",minLevel:1},{sku:"pet_shard_01",name:"Dragon Egg Shard",rarity:"SR",type:"pet",minLevel:1},{sku:"pet_shard_02",name:"Phoenix Egg Shard",rarity:"SR",type:"pet",minLevel:1},{sku:"pet_shard_03",name:"Unicorn Egg Shard",rarity:"SR",type:"pet",minLevel:1},{sku:"pet_01",name:"Mini Dragon",rarity:"SSR",type:"pet",minLevel:1},{sku:"pet_02",name:"Phoenix Companion",rarity:"SSR",type:"pet",minLevel:1},{sku:"pet_03",name:"Unicorn Friend",rarity:"SSR",type:"pet",minLevel:1}],t.rollLoot=(e,s,a,i)=>{let r=new n(e),o=r.rollRarity(s,i),l=t.SAMPLE_LOOT_ITEMS.filter(e=>e.minLevel<=a);return r.rollItem(o,l)}},227:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushSubscribeRequest=t.BossResolveRequest=t.BossStartRequest=t.CompleteSessionResponse=t.CompleteSessionRequest=t.StartSessionResponse=t.StartSessionRequest=t.SubscriptionSchema=t.PushSubscriptionSchema=t.LootSchema=t.ClassSchema=t.ShopItemSchema=t.InventorySchema=t.SessionSchema=t.PlayerSchema=t.ProfileSchema=t.MoodState=t.PlayerClass=t.BossTier=t.SessionOutcome=t.SessionAction=void 0;let a=s(8859);t.SessionAction=a.z.nativeEnum({Train:"Train",Eat:"Eat",Learn:"Learn",Bathe:"Bathe",Sleep:"Sleep",Maintain:"Maintain",Fight:"Fight",Adventure:"Adventure"}),t.SessionOutcome=a.z.enum(["success","fail","early_stop"]),t.BossTier=a.z.enum(["none","mini","big"]),t.PlayerClass=a.z.enum(["Fighter","Rogue","Wizard","Cleric","Ranger"]),t.MoodState=a.z.enum(["Warm","Happy","Excited","Focused","Determined"]),t.ProfileSchema=a.z.object({user_id:a.z.string().uuid(),display_name:a.z.string().min(1).max(50),created_at:a.z.string().datetime()}),t.PlayerSchema=a.z.object({id:a.z.string().uuid(),user_id:a.z.string().uuid(),level:a.z.number().int().min(1),xp:a.z.number().int().min(0),coins:a.z.number().int().min(0),sparks:a.z.number().int().min(0),is_inspired:a.z.boolean(),bond_score:a.z.number().int().min(0).max(100),mood_state:t.MoodState,day_streak:a.z.number().int().min(0),created_at:a.z.string().datetime(),display_name:a.z.string().min(1).max(50).optional()}),t.SessionSchema=a.z.object({id:a.z.string().uuid(),user_id:a.z.string().uuid(),action:t.SessionAction,started_at:a.z.string().datetime(),ended_at:a.z.string().datetime().optional(),outcome:t.SessionOutcome.optional(),disturbed_seconds:a.z.number().int().min(0).default(0),dungeon_floor:a.z.number().int().min(0).default(0),boss_tier:t.BossTier.default("none")}),t.InventorySchema=a.z.object({id:a.z.string().uuid(),user_id:a.z.string().uuid(),sku:a.z.string(),type:a.z.enum(["cosmetic","pet","trinket"]),qty:a.z.number().int().min(1).default(1),equipped:a.z.boolean().default(!1)}),t.ShopItemSchema=a.z.object({sku:a.z.string(),name:a.z.string(),price_coins:a.z.number().int().min(0),price_sparks:a.z.number().int().min(0),type:a.z.string(),class_lock:a.z.string().optional(),min_level:a.z.number().int().min(1).default(1)}),t.ClassSchema=a.z.object({user_id:a.z.string().uuid(),class_id:a.z.string(),unlocked:a.z.boolean(),quest_state:a.z.record(a.z.any())}),t.LootSchema=a.z.object({id:a.z.string().uuid(),session_id:a.z.string().uuid(),sku:a.z.string(),rarity:a.z.enum(["C","U","R","SR","SSR"])}),t.PushSubscriptionSchema=a.z.object({id:a.z.string().uuid(),user_id:a.z.string().uuid(),endpoint:a.z.string().url(),p256dh:a.z.string(),auth:a.z.string()}),t.SubscriptionSchema=a.z.object({user_id:a.z.string().uuid(),provider:a.z.string(),status:a.z.string(),expires_at:a.z.string().datetime().optional()}),t.StartSessionRequest=a.z.object({action:t.SessionAction,duration_minutes:a.z.number().int().min(5).max(120)}),t.StartSessionResponse=a.z.object({session_id:a.z.string().uuid(),expected_end_time:a.z.string().datetime(),nonce:a.z.string()}),t.CompleteSessionRequest=a.z.object({session_id:a.z.string().uuid(),actual_duration_minutes:a.z.number().int().min(0),disturbed_seconds:a.z.number().int().min(0),outcome:t.SessionOutcome}),t.CompleteSessionResponse=a.z.object({xp_gained:a.z.number().int().min(0),coins_gained:a.z.number().int().min(0),sparks_gained:a.z.number().int().min(0),level_up:a.z.boolean(),new_level:a.z.number().int().min(1),streak_updated:a.z.boolean(),new_streak:a.z.number().int().min(0),loot:a.z.array(a.z.object({sku:a.z.string(),name:a.z.string(),rarity:a.z.string(),type:a.z.string()})).optional()}),t.BossStartRequest=a.z.object({boss_tier:t.BossTier,duration_hours:a.z.number().int().min(1).max(24)}),t.BossResolveRequest=a.z.object({boss_id:a.z.string().uuid()}),t.PushSubscribeRequest=a.z.object({endpoint:a.z.string().url(),p256dh:a.z.string(),auth:a.z.string()})}},function(e){e.O(0,[646,294,569,293,528,744],function(){return e(e.s=4178)}),_N_E=e.O()}]);